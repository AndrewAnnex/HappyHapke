
# coding: utf-8

# In[1]:


#Import Files here
import numpy as np
from matplotlib import pyplot as plt
from matplotlib.figure import Figure
from matplotlib.ticker import MaxNLocator


# In[2]:


#Decalarations go here

no_grain_samples = 3
total_guesses = no_grain_samples * 4 # (4 is for B,C,S,D values)
guess_key = 'sml'
num_solns = 1

#Small Grain
lowb_sml, upb_sml = -1.7, -1.7
lowc_sml, upc_sml = -1.0, 1.0
lows_sml, ups_sml = 0, 0.06
lowD_sml, upD_sml = -1.7, -1.7

#Medium Grain
lowb_med, upb_med = -1.7, -1.7
lowc_med, upc_med = -1.0, 1.0
lows_med, ups_med = 0, 0.06
lowD_med, upD_med = -1.7, -1.7

#Large Grain
lowb_big, upb_big = -1.7, -1.7
lowc_big, upc_big = -1.0, 1.0
lows_big, ups_big = 0, 0.06
lowD_big, upD_big = -1.7, -1.7

lowk, upk = 1e-8, 0.1

#########################################################################################
ks = {'sml': np.array([1.57813825e-05, 1.55072622e-05, 1.51729805e-05, 1.47812784e-05,
       1.43374086e-05, 1.42503010e-05, 1.28658756e-05, 1.22569961e-05,
       1.25659066e-05, 1.20329208e-05, 1.05370115e-05, 1.01674243e-05,
       1.03023829e-05, 9.93657613e-06, 9.69658917e-06, 9.55709331e-06,
       9.07391733e-06, 8.73222582e-06, 8.59204925e-06, 8.43059244e-06,
       8.23701159e-06, 8.04907802e-06, 7.92930401e-06, 7.72484039e-06,
       7.50672704e-06, 7.29284267e-06, 7.03388007e-06, 6.69074529e-06,
       6.38204558e-06, 6.11305710e-06, 5.92372211e-06, 5.81536115e-06,
       5.76544700e-06, 5.69969165e-06, 5.68098537e-06, 5.63658743e-06,
       5.57777816e-06, 5.55151415e-06, 5.50308790e-06, 5.49992578e-06,
       5.45069327e-06, 5.39083752e-06, 5.36628737e-06, 5.35133958e-06,
       5.35892584e-06, 5.35246100e-06, 5.34514160e-06, 5.35308443e-06,
       5.41363907e-06, 5.41255977e-06, 5.45173411e-06, 5.60456452e-06,
       5.66702401e-06, 5.83654793e-06, 5.91515048e-06, 6.02375038e-06,
       6.16622604e-06, 6.32324972e-06, 6.50123377e-06, 6.65254972e-06,
       6.87180893e-06, 6.95827864e-06, 7.22973496e-06, 7.33016369e-06,
       7.47580234e-06, 7.46901052e-06, 7.69719998e-06, 7.79838316e-06,
       8.10313324e-06, 8.32804525e-06, 8.59539441e-06, 8.88263082e-06,
       9.30669981e-06, 9.56106026e-06, 9.92905085e-06, 1.03236321e-05,
       1.08663697e-05, 1.14384173e-05, 1.19716499e-05, 1.23451836e-05,
       1.28546977e-05, 1.34389611e-05, 1.37966261e-05, 1.45138543e-05,
       1.50741963e-05, 1.55879856e-05, 1.60540494e-05, 1.66849688e-05,
       1.71463338e-05, 1.75695647e-05, 1.80645595e-05, 1.83547617e-05,
       1.89522211e-05, 1.93743251e-05, 1.97100722e-05, 1.97100362e-05,
       2.01335137e-05, 2.03445209e-05, 2.04795654e-05, 2.05955417e-05,
       2.05226349e-05, 2.06818559e-05, 2.06964502e-05, 2.06939789e-05,
       2.06462310e-05, 2.03838459e-05, 1.99586883e-05, 2.01688960e-05,
       2.01470197e-05, 2.02460768e-05, 2.04038881e-05, 2.07074271e-05,
       2.08638781e-05, 2.09031969e-05, 2.08257019e-05, 2.05326715e-05,
       2.01454878e-05, 1.98213105e-05, 1.95381844e-05, 1.91470688e-05,
       1.86651185e-05, 1.83318243e-05, 1.79639662e-05, 1.76268493e-05,
       1.73553909e-05, 1.71296409e-05, 1.70068657e-05, 1.69073819e-05,
       1.66867315e-05, 1.65344309e-05, 1.63100011e-05, 1.62546913e-05,
       1.61925303e-05, 1.61248300e-05, 1.59535921e-05, 1.57346244e-05,
       1.56949721e-05, 1.54214214e-05, 1.52592759e-05, 1.51455005e-05,
       1.50901174e-05, 1.52094652e-05, 1.51647164e-05, 1.52862034e-05,
       1.53996975e-05, 1.55471857e-05, 1.55924438e-05, 1.55665906e-05,
       1.53658552e-05, 1.53327611e-05, 1.53626349e-05, 1.53605210e-05,
       1.52842224e-05, 1.52662129e-05, 1.53803986e-05, 1.55831295e-05,
       1.58793342e-05, 1.67058923e-05, 1.80536304e-05, 2.09613065e-05,
       2.59097235e-05, 3.13015019e-05, 3.65387594e-05, 4.19499548e-05,
       4.56852636e-05, 4.46973548e-05, 4.27452648e-05, 4.13607990e-05,
       3.94408835e-05, 3.69679483e-05, 3.40116424e-05, 3.16376192e-05,
       2.99137576e-05, 2.84446060e-05, 2.76389178e-05, 2.71052707e-05,
       2.65786847e-05, 2.57097772e-05, 2.48524754e-05, 2.43272083e-05,
       2.36595093e-05, 2.33312398e-05, 2.28303501e-05, 2.25131636e-05,
       2.22409113e-05, 2.21639923e-05, 2.21902173e-05, 2.19824302e-05,
       2.17223511e-05, 2.15354595e-05, 2.12448670e-05, 2.08341823e-05,
       2.04942182e-05, 2.02671559e-05, 2.02239684e-05, 2.02198448e-05,
       2.02584100e-05, 1.99623712e-05, 2.04125947e-05, 2.06517681e-05,
       2.13420220e-05, 2.19568249e-05, 2.24820523e-05, 2.30848466e-05,
       2.37665646e-05, 2.48313418e-05, 2.60023619e-05, 2.78625295e-05,
       3.02155263e-05, 3.29663941e-05, 3.58669394e-05, 3.91165094e-05,
       4.16128010e-05, 4.34318369e-05, 4.47928387e-05]), 
      'med': np.array([2.16542394e-05, 2.16037748e-05, 2.14110090e-05, 2.10836597e-05,
       2.06275898e-05, 2.07849109e-05, 1.85872573e-05, 1.76714292e-05,
       1.85519513e-05, 1.77012770e-05, 1.52284313e-05, 1.45992013e-05,
       1.49685638e-05, 1.44487867e-05, 1.41171983e-05, 1.39188484e-05,
       1.32053880e-05, 1.27102082e-05, 1.25366629e-05, 1.23482037e-05,
       1.20059214e-05, 1.17645787e-05, 1.15442135e-05, 1.12952812e-05,
       1.10886991e-05, 1.07067305e-05, 1.03642937e-05, 9.90447512e-06,
       9.48857969e-06, 9.09903148e-06, 8.83193356e-06, 8.67196260e-06,
       8.57882096e-06, 8.51632833e-06, 8.46958775e-06, 8.45924203e-06,
       8.38027652e-06, 8.31493725e-06, 8.23456502e-06, 8.22720295e-06,
       8.14092738e-06, 8.06655539e-06, 8.01259444e-06, 7.99878170e-06,
       7.97919275e-06, 7.95332085e-06, 8.02710517e-06, 8.01949677e-06,
       8.10827408e-06, 8.19905249e-06, 8.23434719e-06, 8.42811239e-06,
       8.61545085e-06, 8.82369461e-06, 8.98925394e-06, 9.18399535e-06,
       9.39254836e-06, 9.62792220e-06, 9.79825500e-06, 9.98525654e-06,
       1.02460202e-05, 1.05305664e-05, 1.08341039e-05, 1.10372816e-05,
       1.13325192e-05, 1.13768301e-05, 1.17381862e-05, 1.19633299e-05,
       1.24469481e-05, 1.28237597e-05, 1.32695696e-05, 1.37478066e-05,
       1.43768607e-05, 1.49309416e-05, 1.56441617e-05, 1.62603941e-05,
       1.69947158e-05, 1.77802188e-05, 1.86090887e-05, 1.94741162e-05,
       2.05171045e-05, 2.14086774e-05, 2.22627045e-05, 2.31582867e-05,
       2.41200907e-05, 2.50563442e-05, 2.60630569e-05, 2.67777995e-05,
       2.78221629e-05, 2.85506094e-05, 2.91202416e-05, 2.98571255e-05,
       3.05513902e-05, 3.12077819e-05, 3.15579121e-05, 3.21106786e-05,
       3.27824656e-05, 3.30426439e-05, 3.32620988e-05, 3.34891257e-05,
       3.36660119e-05, 3.35873904e-05, 3.35436295e-05, 3.36584932e-05,
       3.36951337e-05, 3.34411189e-05, 3.30297788e-05, 3.31686614e-05,
       3.31174895e-05, 3.31807340e-05, 3.33666164e-05, 3.36868506e-05,
       3.38453413e-05, 3.37166890e-05, 3.38251054e-05, 3.33371603e-05,
       3.29306394e-05, 3.23042100e-05, 3.18184305e-05, 3.09085831e-05,
       3.01078224e-05, 2.95033723e-05, 2.89171193e-05, 2.83579994e-05,
       2.81321065e-05, 2.75494811e-05, 2.73700603e-05, 2.70884354e-05,
       2.68413379e-05, 2.66765408e-05, 2.63197161e-05, 2.61795942e-05,
       2.60249871e-05, 2.59749436e-05, 2.57544233e-05, 2.53817190e-05,
       2.53744682e-05, 2.50245337e-05, 2.46532295e-05, 2.46727995e-05,
       2.44530500e-05, 2.45902924e-05, 2.45299896e-05, 2.47076557e-05,
       2.49579108e-05, 2.49865400e-05, 2.51819578e-05, 2.51509731e-05,
       2.48078368e-05, 2.47609894e-05, 2.47832342e-05, 2.48025402e-05,
       2.49220661e-05, 2.49375537e-05, 2.51463829e-05, 2.54485261e-05,
       2.59944622e-05, 2.72357237e-05, 2.94282445e-05, 3.42359929e-05,
       4.19292723e-05, 5.06189246e-05, 5.91129125e-05, 6.75964059e-05,
       7.31435305e-05, 7.17678618e-05, 6.81941958e-05, 6.61516726e-05,
       6.32139269e-05, 5.92409069e-05, 5.46814170e-05, 5.07876300e-05,
       4.77449274e-05, 4.59409399e-05, 4.45687311e-05, 4.33254474e-05,
       4.25655283e-05, 4.10665581e-05, 3.98439394e-05, 3.88722032e-05,
       3.80449077e-05, 3.72760898e-05, 3.64425077e-05, 3.58538654e-05,
       3.56969733e-05, 3.52985316e-05, 3.54151896e-05, 3.50756569e-05,
       3.47845805e-05, 3.43644211e-05, 3.38650025e-05, 3.33645555e-05,
       3.26824446e-05, 3.25047817e-05, 3.25532948e-05, 3.23491358e-05,
       3.21354415e-05, 3.18337543e-05, 3.20354855e-05, 3.28977198e-05,
       3.33875357e-05, 3.44433681e-05, 3.52260742e-05, 3.66744541e-05,
       3.75117972e-05, 3.92516487e-05, 4.15769056e-05, 4.43412236e-05,
       4.82279220e-05, 5.23932854e-05, 5.70085189e-05, 6.20972410e-05,
       6.64706925e-05, 6.93963820e-05, 7.14786772e-05]), 
      'big': np.array([2.60013489e-05, 2.60857050e-05, 2.59588522e-05, 2.56295797e-05,
       2.51048955e-05, 2.52999549e-05, 2.25990976e-05, 2.13878783e-05,
       2.23491794e-05, 2.13266064e-05, 1.81456105e-05, 1.74457230e-05,
       1.78398357e-05, 1.72335842e-05, 1.67701602e-05, 1.65018791e-05,
       1.56424302e-05, 1.50163495e-05, 1.48160528e-05, 1.45365385e-05,
       1.42114380e-05, 1.38503697e-05, 1.35846936e-05, 1.32739386e-05,
       1.29401640e-05, 1.25623988e-05, 1.20856279e-05, 1.15466632e-05,
       1.10262741e-05, 1.06169930e-05, 1.03165622e-05, 1.00961254e-05,
       1.00359133e-05, 9.94493312e-06, 9.90449065e-06, 9.85128755e-06,
       9.77635306e-06, 9.71236006e-06, 9.66841589e-06, 9.61319776e-06,
       9.55578651e-06, 9.47101317e-06, 9.45022941e-06, 9.37947240e-06,
       9.37885365e-06, 9.34596120e-06, 9.36136660e-06, 9.40989971e-06,
       9.47135797e-06, 9.53982653e-06, 9.61755743e-06, 9.82960095e-06,
       1.00351995e-05, 1.02746387e-05, 1.05222638e-05, 1.07501928e-05,
       1.10228590e-05, 1.13098982e-05, 1.14682813e-05, 1.17150249e-05,
       1.19143896e-05, 1.24636587e-05, 1.27573355e-05, 1.30169394e-05,
       1.32818605e-05, 1.34744023e-05, 1.38319355e-05, 1.41921931e-05,
       1.46739461e-05, 1.51523834e-05, 1.56966782e-05, 1.63854487e-05,
       1.70671806e-05, 1.77373409e-05, 1.85419101e-05, 1.93813332e-05,
       2.03563136e-05, 2.14252171e-05, 2.24671382e-05, 2.34668322e-05,
       2.45205583e-05, 2.57371421e-05, 2.67795153e-05, 2.80378926e-05,
       2.90165461e-05, 3.02682244e-05, 3.13775775e-05, 3.24580342e-05,
       3.37088893e-05, 3.46475075e-05, 3.55173704e-05, 3.63797508e-05,
       3.72172843e-05, 3.82624972e-05, 3.86179242e-05, 3.91881912e-05,
       3.99381161e-05, 4.05487889e-05, 4.07383094e-05, 4.09521599e-05,
       4.09514902e-05, 4.09138686e-05, 4.08286220e-05, 4.11329225e-05,
       4.09241075e-05, 4.08285669e-05, 4.01769137e-05, 4.03214740e-05,
       4.02539029e-05, 4.03787072e-05, 4.07569013e-05, 4.11633368e-05,
       4.18263841e-05, 4.13740113e-05, 4.16058871e-05, 4.09968544e-05,
       4.06344356e-05, 3.98068852e-05, 3.91097138e-05, 3.79820203e-05,
       3.71271189e-05, 3.62830968e-05, 3.52811211e-05, 3.46519923e-05,
       3.44902666e-05, 3.37352608e-05, 3.33859788e-05, 3.30470983e-05,
       3.25997898e-05, 3.26375736e-05, 3.21254569e-05, 3.19066664e-05,
       3.16506170e-05, 3.16217803e-05, 3.11777406e-05, 3.10515757e-05,
       3.06857398e-05, 3.02703962e-05, 2.99935270e-05, 2.98818678e-05,
       2.98402482e-05, 2.97304178e-05, 2.97694445e-05, 3.00322988e-05,
       3.02058959e-05, 3.04606460e-05, 3.05783525e-05, 3.03675375e-05,
       3.02173976e-05, 3.01977834e-05, 3.00254916e-05, 3.02022551e-05,
       3.03771266e-05, 3.03507808e-05, 3.07757109e-05, 3.12324262e-05,
       3.17640642e-05, 3.36088856e-05, 3.62061583e-05, 4.23916611e-05,
       5.30252503e-05, 6.47796748e-05, 7.52804066e-05, 8.67184294e-05,
       9.36936244e-05, 9.21502405e-05, 8.80663843e-05, 8.50285465e-05,
       8.09169913e-05, 7.57434634e-05, 6.92665932e-05, 6.43917140e-05,
       6.08904369e-05, 5.76667456e-05, 5.60908788e-05, 5.47201567e-05,
       5.34918667e-05, 5.14402152e-05, 4.95099244e-05, 4.84660852e-05,
       4.72092443e-05, 4.62871637e-05, 4.52073722e-05, 4.45164623e-05,
       4.38852920e-05, 4.34156382e-05, 4.33524437e-05, 4.31824972e-05,
       4.24646012e-05, 4.22278864e-05, 4.18537253e-05, 4.10185728e-05,
       4.04319582e-05, 3.97841828e-05, 3.96119692e-05, 3.93025851e-05,
       3.92928329e-05, 3.90760230e-05, 3.92883665e-05, 4.00788715e-05,
       4.07858429e-05, 4.19737630e-05, 4.32969253e-05, 4.47368197e-05,
       4.59466390e-05, 4.82994309e-05, 5.14525174e-05, 5.57082864e-05,
       6.04499753e-05, 6.62036959e-05, 7.26058503e-05, 7.93445106e-05,
       8.50431562e-05, 8.88395551e-05, 9.11360045e-05])}


self_guesses = {'sml': (0.1, 0.3, 0.0, 63.0, 0.0000000001), 'med': (0.1, 0.3, 0.0, 63.0, 0.0.0000000001), 'big': (0.1, 0.3, 0.0, 63.0, 0.0000000001)}


# In[23]:


self_spectra = {'sml': np.array([[0.32   , 0.29893],
       [0.33   , 0.3858 ],
       [0.34   , 0.44703],
       [0.35   , 0.48226],
       [0.36   , 0.50419],
       [0.37   , 0.51687],
       [0.38   , 0.51717],
       [0.39   , 0.5287 ],
       [0.4    , 0.55469],
       [0.41   , 0.56452],
       [0.42   , 0.56629],
       [0.43   , 0.5759 ],
       [0.44   , 0.58349],
       [0.45   , 0.58932],
       [0.46   , 0.60099],
       [0.47   , 0.61031],
       [0.48   , 0.61611],
       [0.49   , 0.62217],
       [0.5    , 0.62881],
       [0.51   , 0.63531],
       [0.52   , 0.64048],
       [0.53   , 0.64721],
       [0.54   , 0.6542 ],
       [0.55   , 0.66113],
       [0.56   , 0.66894],
       [0.57   , 0.67868],
       [0.58   , 0.68766],
       [0.59   , 0.69613],
       [0.6    , 0.70258],
       [0.61   , 0.70745],
       [0.62   , 0.71085],
       [0.63   , 0.71451],
       [0.64   , 0.71699],
       [0.65   , 0.71997],
       [0.66   , 0.72339],
       [0.67   , 0.72606],
       [0.68   , 0.72918],
       [0.69   , 0.73115],
       [0.7    , 0.73413],
       [0.71   , 0.73727],
       [0.72   , 0.73953],
       [0.73   , 0.74154],
       [0.74   , 0.74316],
       [0.75   , 0.74508],
       [0.76   , 0.74697],
       [0.77   , 0.74845],
       [0.78   , 0.74866],
       [0.79   , 0.75029],
       [0.8    , 0.75096],
       [0.81   , 0.74905],
       [0.82   , 0.7492 ],
       [0.83   , 0.74699],
       [0.84   , 0.74681],
       [0.85   , 0.74599],
       [0.86   , 0.74447],
       [0.87   , 0.74268],
       [0.88   , 0.74059],
       [0.89   , 0.73918],
       [0.9    , 0.73658],
       [0.91   , 0.7364 ],
       [0.92   , 0.73297],
       [0.93   , 0.73259],
       [0.94   , 0.73144],
       [0.95   , 0.73291],
       [0.96   , 0.73039],
       [0.97   , 0.73004],
       [0.98   , 0.72634],
       [0.99   , 0.72402],
       [1.     , 0.72108],
       [1.01   , 0.71818],
       [1.02   , 0.71339],
       [1.03   , 0.71109],
       [1.04   , 0.70725],
       [1.05   , 0.70312],
       [1.06   , 0.69758],
       [1.07   , 0.69179],
       [1.08   , 0.68659],
       [1.09   , 0.68367],
       [1.1    , 0.67931],
       [1.11   , 0.67422],
       [1.12   , 0.67167],
       [1.13   , 0.66577],
       [1.14   , 0.66154],
       [1.15   , 0.65784],
       [1.16   , 0.65484],
       [1.17   , 0.65047],
       [1.18   , 0.64767],
       [1.19   , 0.64525],
       [1.2    , 0.64237],
       [1.21   , 0.64125],
       [1.22   , 0.63771],
       [1.23   , 0.63561],
       [1.24   , 0.63422],
       [1.25   , 0.63545],
       [1.26   , 0.63341],
       [1.27   , 0.63302],
       [1.28   , 0.63321],
       [1.29   , 0.63354],
       [1.3    , 0.63527],
       [1.31   , 0.63526],
       [1.32   , 0.63631],
       [1.33   , 0.63747],
       [1.34   , 0.63894],
       [1.35   , 0.64193],
       [1.36   , 0.64617],
       [1.37   , 0.64569],
       [1.38   , 0.64696],
       [1.39   , 0.64731],
       [1.4    , 0.64722],
       [1.41   , 0.64606],
       [1.42   , 0.64599],
       [1.43   , 0.64677],
       [1.44   , 0.64838],
       [1.45   , 0.65151],
       [1.46   , 0.65527],
       [1.47   , 0.65863],
       [1.48   , 0.66178],
       [1.49   , 0.6657 ],
       [1.5    , 0.67025],
       [1.51   , 0.67382],
       [1.52   , 0.67771],
       [1.53   , 0.68131],
       [1.54   , 0.68435],
       [1.55   , 0.68703],
       [1.56   , 0.689  ],
       [1.57   , 0.69075],
       [1.58   , 0.69349],
       [1.59   , 0.69563],
       [1.6    , 0.69834],
       [1.61   , 0.69963],
       [1.62   , 0.70096],
       [1.63   , 0.70232],
       [1.64   , 0.70463],
       [1.65   , 0.70741],
       [1.66   , 0.70859],
       [1.67   , 0.71179],
       [1.68   , 0.71399],
       [1.69   , 0.71575],
       [1.7    , 0.71699],
       [1.71   , 0.71673],
       [1.72   , 0.71786],
       [1.73   , 0.71758],
       [1.74   , 0.71737],
       [1.75   , 0.71688],
       [1.76   , 0.71724],
       [1.77   , 0.71818],
       [1.78   , 0.72054],
       [1.79   , 0.72154],
       [1.8    , 0.72204],
       [1.81   , 0.72282],
       [1.82   , 0.72425],
       [1.83   , 0.72515],
       [1.84   , 0.72488],
       [1.85   , 0.72384],
       [1.86   , 0.722  ],
       [1.87   , 0.71616],
       [1.88   , 0.70644],
       [1.89   , 0.68652],
       [1.9    , 0.65695],
       [1.91   , 0.62959],
       [1.92   , 0.6066 ],
       [1.93   , 0.58568],
       [1.94   , 0.57286],
       [1.95   , 0.57719],
       [1.96   , 0.58515],
       [1.97   , 0.59117],
       [1.98   , 0.59943],
       [1.99   , 0.61033],
       [2.     , 0.62398],
       [2.01   , 0.63572],
       [2.02   , 0.64479],
       [2.03   , 0.65305],
       [2.04   , 0.65791],
       [2.05   , 0.66155],
       [2.06   , 0.66512],
       [2.07   , 0.67051],
       [2.08   , 0.67614],
       [2.09   , 0.67987],
       [2.1    , 0.68439],
       [2.11   , 0.68695],
       [2.12   , 0.69075],
       [2.13   , 0.69338],
       [2.14   , 0.69571],
       [2.15   , 0.69682],
       [2.16   , 0.69729],
       [2.17   , 0.69918],
       [2.18   , 0.70137],
       [2.19   , 0.7031 ],
       [2.2    , 0.70566],
       [2.21   , 0.70899],
       [2.22   , 0.71183],
       [2.23   , 0.71391],
       [2.24   , 0.71478],
       [2.25   , 0.71539],
       [2.26   , 0.71572],
       [2.27   , 0.71819],
       [2.28   , 0.71588],
       [2.29   , 0.71493],
       [2.3    , 0.71114],
       [2.31   , 0.70786],
       [2.32   , 0.70517],
       [2.33   , 0.70212],
       [2.34   , 0.69883],
       [2.35   , 0.69342],
       [2.36   , 0.68747],
       [2.37   , 0.67846],
       [2.38   , 0.66743],
       [2.39   , 0.65532],
       [2.4    , 0.64343],
       [2.41   , 0.63102],
       [2.42   , 0.62226],
       [2.43   , 0.61634],
       [2.44   , 0.6122 ],
       [2.45   , 0.60854],
       [2.46   , 0.60443],
       [2.47   , 0.60027],
       [2.48   , 0.60142],
       [2.49   , 0.60132],
       [2.5    , 0.60027],
       [2.51   , 0.60204],
       [2.52   , 0.60122],
       [2.53   , 0.60104],
       [2.54   , 0.60176],
       [2.55   , 0.60207]]), 
 'med': np.array([[0.32   , 0.22541],
       [0.33   , 0.31136],
       [0.34   , 0.38   ],
       [0.35   , 0.41829],
       [0.36   , 0.44201],
       [0.37   , 0.45524],
       [0.38   , 0.45151],
       [0.39   , 0.46387],
       [0.4    , 0.49358],
       [0.41   , 0.50481],
       [0.42   , 0.50466],
       [0.43   , 0.51451],
       [0.44   , 0.5222 ],
       [0.45   , 0.52829],
       [0.46   , 0.54062],
       [0.47   , 0.55042],
       [0.48   , 0.5561 ],
       [0.49   , 0.56188],
       [0.5    , 0.5697 ],
       [0.51   , 0.57618],
       [0.52   , 0.58231],
       [0.53   , 0.58876],
       [0.54   , 0.59469],
       [0.55   , 0.60308],
       [0.56   , 0.61092],
       [0.57   , 0.62062],
       [0.58   , 0.62985],
       [0.59   , 0.6388 ],
       [0.6    , 0.64571],
       [0.61   , 0.65093],
       [0.62   , 0.65487],
       [0.63   , 0.65825],
       [0.64   , 0.66142],
       [0.65   , 0.66387],
       [0.66   , 0.66741],
       [0.67   , 0.67062],
       [0.68   , 0.67419],
       [0.69   , 0.67644],
       [0.7    , 0.67999],
       [0.71   , 0.68324],
       [0.72   , 0.68606],
       [0.73   , 0.68827],
       [0.74   , 0.69057],
       [0.75   , 0.69292],
       [0.76   , 0.69348],
       [0.77   , 0.69542],
       [0.78   , 0.69568],
       [0.79   , 0.6959 ],
       [0.8    , 0.69703],
       [0.81   , 0.69555],
       [0.82   , 0.69421],
       [0.83   , 0.69257],
       [0.84   , 0.69164],
       [0.85   , 0.69028],
       [0.86   , 0.68874],
       [0.87   , 0.68683],
       [0.88   , 0.68599],
       [0.89   , 0.68496],
       [0.9    , 0.68296],
       [0.91   , 0.68069],
       [0.92   , 0.67822],
       [0.93   , 0.67711],
       [0.94   , 0.67484],
       [0.95   , 0.67581],
       [0.96   , 0.67277],
       [0.97   , 0.67149],
       [0.98   , 0.66737],
       [0.99   , 0.66455],
       [1.     , 0.66102],
       [1.01   , 0.65721],
       [1.02   , 0.65219],
       [1.03   , 0.64803],
       [1.04   , 0.64248],
       [1.05   , 0.63818],
       [1.06   , 0.63289],
       [1.07   , 0.62751],
       [1.08   , 0.62194],
       [1.09   , 0.6164 ],
       [1.1    , 0.60969],
       [1.11   , 0.60453],
       [1.12   , 0.59977],
       [1.13   , 0.595  ],
       [1.14   , 0.58993],
       [1.15   , 0.5853 ],
       [1.16   , 0.58037],
       [1.17   , 0.57743],
       [1.18   , 0.57266],
       [1.19   , 0.56983],
       [1.2    , 0.56802],
       [1.21   , 0.56533],
       [1.22   , 0.56292],
       [1.23   , 0.56079],
       [1.24   , 0.5603 ],
       [1.25   , 0.5588 ],
       [1.26   , 0.55673],
       [1.27   , 0.55673],
       [1.28   , 0.55693],
       [1.29   , 0.55709],
       [1.3    , 0.55749],
       [1.31   , 0.55911],
       [1.32   , 0.56054],
       [1.33   , 0.5612 ],
       [1.34   , 0.56224],
       [1.35   , 0.5647 ],
       [1.36   , 0.56789],
       [1.37   , 0.56839],
       [1.38   , 0.56979],
       [1.39   , 0.57064],
       [1.4    , 0.5709 ],
       [1.41   , 0.5705 ],
       [1.42   , 0.57089],
       [1.43   , 0.57266],
       [1.44   , 0.57327],
       [1.45   , 0.57671],
       [1.46   , 0.57974],
       [1.47   , 0.58394],
       [1.48   , 0.5874 ],
       [1.49   , 0.59309],
       [1.5    , 0.59823],
       [1.51   , 0.6025 ],
       [1.52   , 0.60665],
       [1.53   , 0.61069],
       [1.54   , 0.61297],
       [1.55   , 0.61719],
       [1.56   , 0.61915],
       [1.57   , 0.62173],
       [1.58   , 0.62414],
       [1.59   , 0.62605],
       [1.6    , 0.62903],
       [1.61   , 0.63075],
       [1.62   , 0.63258],
       [1.63   , 0.63383],
       [1.64   , 0.63607],
       [1.65   , 0.63918],
       [1.66   , 0.64012],
       [1.67   , 0.64304],
       [1.68   , 0.64618],
       [1.69   , 0.64696],
       [1.7    , 0.64919],
       [1.71   , 0.64923],
       [1.72   , 0.65046],
       [1.73   , 0.65025],
       [1.74   , 0.64961],
       [1.75   , 0.65029],
       [1.76   , 0.64998],
       [1.77   , 0.651  ],
       [1.78   , 0.65383],
       [1.79   , 0.65491],
       [1.8    , 0.65558],
       [1.81   , 0.65626],
       [1.82   , 0.65636],
       [1.83   , 0.65705],
       [1.84   , 0.65664],
       [1.85   , 0.65571],
       [1.86   , 0.65343],
       [1.87   , 0.64732],
       [1.88   , 0.63656],
       [1.89   , 0.61428],
       [1.9    , 0.58327],
       [1.91   , 0.55369],
       [1.92   , 0.52905],
       [1.93   , 0.50758],
       [1.94   , 0.49521],
       [1.95   , 0.49927],
       [1.96   , 0.50868],
       [1.97   , 0.51462],
       [1.98   , 0.52301],
       [1.99   , 0.53463],
       [2.     , 0.54863],
       [2.01   , 0.56145],
       [2.02   , 0.57226],
       [2.03   , 0.5792 ],
       [2.04   , 0.58487],
       [2.05   , 0.59011],
       [2.06   , 0.59371],
       [2.07   , 0.60008],
       [2.08   , 0.60559],
       [2.09   , 0.61014],
       [2.1    , 0.61426],
       [2.11   , 0.61811],
       [2.12   , 0.62231],
       [2.13   , 0.62555],
       [2.14   , 0.62693],
       [2.15   , 0.62932],
       [2.16   , 0.62952],
       [2.17   , 0.63163],
       [2.18   , 0.63363],
       [2.19   , 0.63619],
       [2.2    , 0.63908],
       [2.21   , 0.64195],
       [2.22   , 0.64569],
       [2.23   , 0.6472 ],
       [2.24   , 0.64765],
       [2.25   , 0.64926],
       [2.26   , 0.6509 ],
       [2.27   , 0.65293],
       [2.28   , 0.65265],
       [2.29   , 0.64938],
       [2.3    , 0.64782],
       [2.31   , 0.64376],
       [2.32   , 0.64111],
       [2.33   , 0.63572],
       [2.34   , 0.63291],
       [2.35   , 0.62673],
       [2.36   , 0.61853],
       [2.37   , 0.6092 ],
       [2.38   , 0.59676],
       [2.39   , 0.58433],
       [2.4    , 0.57145],
       [2.41   , 0.55831],
       [2.42   , 0.54787],
       [2.43   , 0.54148],
       [2.44   , 0.53726],
       [2.45   , 0.53378],
       [2.46   , 0.53085],
       [2.47   , 0.52689],
       [2.48   , 0.52834],
       [2.49   , 0.52697],
       [2.5    , 0.52607],
       [2.51   , 0.52747],
       [2.52   , 0.52797],
       [2.53   , 0.52662],
       [2.54   , 0.52679],
       [2.55   , 0.52395]]), 
 'big': np.array([[0.32   , 0.20208],
       [0.33   , 0.2809 ],
       [0.34   , 0.34665],
       [0.35   , 0.38513],
       [0.36   , 0.40889],
       [0.37   , 0.42286],
       [0.38   , 0.41992],
       [0.39   , 0.43227],
       [0.4    , 0.46396],
       [0.41   , 0.4748 ],
       [0.42   , 0.4751 ],
       [0.43   , 0.4849 ],
       [0.44   , 0.49339],
       [0.45   , 0.49988],
       [0.46   , 0.51252],
       [0.47   , 0.52289],
       [0.48   , 0.52863],
       [0.49   , 0.5352 ],
       [0.5    , 0.54226],
       [0.51   , 0.54973],
       [0.52   , 0.55606],
       [0.53   , 0.5629 ],
       [0.54   , 0.57002],
       [0.55   , 0.57775],
       [0.56   , 0.5868 ],
       [0.57   , 0.59681],
       [0.58   , 0.60676],
       [0.59   , 0.6153 ],
       [0.6    , 0.62227],
       [0.61   , 0.62811],
       [0.62   , 0.63142],
       [0.63   , 0.63528],
       [0.64   , 0.63828],
       [0.65   , 0.64138],
       [0.66   , 0.64475],
       [0.67   , 0.64803],
       [0.68   , 0.65091],
       [0.69   , 0.65388],
       [0.7    , 0.6568 ],
       [0.71   , 0.66024],
       [0.72   , 0.66263],
       [0.73   , 0.66572],
       [0.74   , 0.66767],
       [0.75   , 0.67005],
       [0.76   , 0.67168],
       [0.77   , 0.67285],
       [0.78   , 0.67379],
       [0.79   , 0.6746 ],
       [0.8    , 0.67525],
       [0.81   , 0.67388],
       [0.82   , 0.67264],
       [0.83   , 0.67097],
       [0.84   , 0.66932],
       [0.85   , 0.66797],
       [0.86   , 0.66607],
       [0.87   , 0.66403],
       [0.88   , 0.66367],
       [0.89   , 0.66221],
       [0.9    , 0.66137],
       [0.91   , 0.65633],
       [0.92   , 0.65456],
       [0.93   , 0.65321],
       [0.94   , 0.65183],
       [0.95   , 0.65127],
       [0.96   , 0.64894],
       [0.97   , 0.64663],
       [0.98   , 0.64315],
       [0.99   , 0.63993],
       [1.     , 0.63614],
       [1.01   , 0.63109],
       [1.02   , 0.62646],
       [1.03   , 0.62203],
       [1.04   , 0.61672],
       [1.05   , 0.61134],
       [1.06   , 0.6052 ],
       [1.07   , 0.5986 ],
       [1.08   , 0.59264],
       [1.09   , 0.58718],
       [1.1    , 0.58165],
       [1.11   , 0.57536],
       [1.12   , 0.57037],
       [1.13   , 0.56443],
       [1.14   , 0.56028],
       [1.15   , 0.55483],
       [1.16   , 0.55038],
       [1.17   , 0.54622],
       [1.18   , 0.54143],
       [1.19   , 0.53827],
       [1.2    , 0.53558],
       [1.21   , 0.53299],
       [1.22   , 0.53056],
       [1.23   , 0.52735],
       [1.24   , 0.52716],
       [1.25   , 0.52606],
       [1.26   , 0.52422],
       [1.27   , 0.523  ],
       [1.28   , 0.52353],
       [1.29   , 0.52396],
       [1.3    , 0.52526],
       [1.31   , 0.52669],
       [1.32   , 0.52829],
       [1.33   , 0.52831],
       [1.34   , 0.53037],
       [1.35   , 0.53201],
       [1.36   , 0.53589],
       [1.37   , 0.5365 ],
       [1.38   , 0.53796],
       [1.39   , 0.53865],
       [1.4    , 0.53829],
       [1.41   , 0.53782],
       [1.42   , 0.53637],
       [1.43   , 0.53932],
       [1.44   , 0.53955],
       [1.45   , 0.54312],
       [1.46   , 0.54568],
       [1.47   , 0.5502 ],
       [1.48   , 0.55417],
       [1.49   , 0.56004],
       [1.5    , 0.56483],
       [1.51   , 0.56959],
       [1.52   , 0.57519],
       [1.53   , 0.57908],
       [1.54   , 0.58089],
       [1.55   , 0.58547],
       [1.56   , 0.58811],
       [1.57   , 0.59076],
       [1.58   , 0.59394],
       [1.59   , 0.59475],
       [1.6    , 0.59818],
       [1.61   , 0.60025],
       [1.62   , 0.60251],
       [1.63   , 0.60362],
       [1.64   , 0.60676],
       [1.65   , 0.60831],
       [1.66   , 0.61111],
       [1.67   , 0.61418],
       [1.68   , 0.61651],
       [1.69   , 0.61798],
       [1.7    , 0.61908],
       [1.71   , 0.62053],
       [1.72   , 0.62124],
       [1.73   , 0.62077],
       [1.74   , 0.62077],
       [1.75   , 0.62035],
       [1.76   , 0.62064],
       [1.77   , 0.62261],
       [1.78   , 0.62425],
       [1.79   , 0.62521],
       [1.8    , 0.62693],
       [1.81   , 0.62688],
       [1.82   , 0.62684],
       [1.83   , 0.6278 ],
       [1.84   , 0.62652],
       [1.85   , 0.6251 ],
       [1.86   , 0.62333],
       [1.87   , 0.61549],
       [1.88   , 0.60476],
       [1.89   , 0.58065],
       [1.9    , 0.54523],
       [1.91   , 0.51296],
       [1.92   , 0.48862],
       [1.93   , 0.46559],
       [1.94   , 0.45334],
       [1.95   , 0.45703],
       [1.96   , 0.46559],
       [1.97   , 0.47239],
       [1.98   , 0.48163],
       [1.99   , 0.49362],
       [2.     , 0.50944],
       [2.01   , 0.52245],
       [2.02   , 0.53256],
       [2.03   , 0.54235],
       [2.04   , 0.5477 ],
       [2.05   , 0.55253],
       [2.06   , 0.55705],
       [2.07   , 0.56418],
       [2.08   , 0.57111],
       [2.09   , 0.57534],
       [2.1    , 0.58028],
       [2.11   , 0.58422],
       [2.12   , 0.58867],
       [2.13   , 0.5919 ],
       [2.14   , 0.5949 ],
       [2.15   , 0.5973 ],
       [2.16   , 0.59824],
       [2.17   , 0.59959],
       [2.18   , 0.60298],
       [2.19   , 0.60457],
       [2.2    , 0.60665],
       [2.21   , 0.61047],
       [2.22   , 0.61344],
       [2.23   , 0.61662],
       [2.24   , 0.61796],
       [2.25   , 0.61981],
       [2.26   , 0.62053],
       [2.27   , 0.62209],
       [2.28   , 0.62193],
       [2.29   , 0.61952],
       [2.3    , 0.61754],
       [2.31   , 0.6138 ],
       [2.32   , 0.6096 ],
       [2.33   , 0.60523],
       [2.34   , 0.60172],
       [2.35   , 0.59455],
       [2.36   , 0.5852 ],
       [2.37   , 0.57316],
       [2.38   , 0.56062],
       [2.39   , 0.54647],
       [2.4    , 0.53196],
       [2.41   , 0.51791],
       [2.42   , 0.50702],
       [2.43   , 0.50039],
       [2.44   , 0.49677],
       [2.45   , 0.49333],
       [2.46   , 0.49004],
       [2.47   , 0.48653],
       [2.48   , 0.48701],
       [2.49   , 0.48709],
       [2.5    , 0.48592],
       [2.51   , 0.48666],
       [2.52   , 0.4869 ],
       [2.53   , 0.48492],
       [2.54   , 0.48318],
       [2.55   , 0.48412]])}


# In[3]:


k = ks[guess_key]
guesses = np.empty(len(k) + total_guesses)
ff = np.zeros(no_grain_samples)


# In[4]:


for i, key in enumerate(self_guesses.keys()):
      g = self_guesses[key]
      # Unpacks the b,c,s,D values for each grain size into one large array. g holds b,c,s,D,f -- we take only the first four
      guesses[i:total_guesses:no_grain_samples] = g[:4] 
      # guesses Example:
      # for sml, med anf big grain sizes
      # [sml-b, med-b, big-g, sml-C, med-C, big-C, sml-S, med-S, big-S, sml-D, med-D, big-D, 215 values of K]
      # total with the length of K - 4 values for each grain size -- this is the magic 12
      ff[i] = g[4]
guesses[total_guesses:] = k 


# In[5]:


# set up bounds
lb = np.empty_like(guesses)
#Values that will be there regardless if additional grain sizes are uploaded
lb[:12] = [lowb_sml, lowb_med, lowb_big, lowc_sml, lowc_med, lowc_big, lows_sml, lows_med, lows_big,
lowD_sml, lowD_med, lowD_big]

#Filling in rest of the values
lb[total_guesses:] = lowk

ub = np.empty_like(guesses)
ub[:12] = [upb_sml, upb_med, upb_big, upc_sml, upc_med, upc_big, ups_sml, ups_med, ups_big,
upD_sml, upD_med, upD_big]
ub[12:] = upk
self_bounds = (lb, ub)


# In[6]:


print("Eli hello")

